group:   
  kong:     
    exists: true 
user:   
  kong:     
    exists: true
file:
  /opt/bitnami/kong/conf/kong.conf:
    exists: true
    contains:
      - "prefix = /opt/bitnami/kong/server"
      - "nginx_daemon = off"
      - "nginx_user = kong"
  /opt/bitnami/scripts/kong-env.sh:
    exists: true
    contains:
      - "\'luarocks path\' configuration"
  /etc/bash.bashrc:
    exists: true
    contains:
      - "\'luarocks path\' configuration"
command:
  # Ensure that there is no uncommented read-only postgres connection parameter in the main Kong configuration file
  check-read-only-conf-values:
    exec: grep -E '^pg_ro.+=.+' kong.conf
    exit-status: 1
  # Ensure that all non-empty keys in the main Kong configuration file are uncommented
  check-status-all-non-empty-keys:
    exec: grep -E '^#+([a-z_ ]+)=\s*[^# ]' kong.conf | grep -v 'pg_ro'
    exit-status: 1