########################
# Checks directories exist,
# optionally checking their permissions
# Needed vars:
#   - .Vars.directories (Array)
#   - .Vars.directories.paths (Array)
# Optional vars:
#   - .Vars.directories.mode (String)
#   - .Vars.directories.owner (String)
#   - .Vars.directories.group (String)
########################
file:
  {{ range $dirs := .Vars.directories }}
  {{ range $path := .paths }}
  {{ $path }}:
    exists: true
    filetype: directory
    {{ if and (index $dir "mode") }}
    mode: "{{ printf "%s" $dir.mode }}"
    {{ end }}
    {{ if and (index $dir "owner") }}
    owner: {{ printf "%s" $dir.owner }}
    {{ end }}
    {{ if and (index $dir "group") }}
    group: {{ printf "%s" $dir.group }}
    {{ end }}
  {{ end }}
  {{ end }}
